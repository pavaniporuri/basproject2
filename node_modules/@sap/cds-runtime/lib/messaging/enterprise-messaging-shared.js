const BaseMessaging = require('./BaseMessaging')
const AMQPClient = require('./common-utils/AMQPClient')
const optionsMessaging = require('./enterprise-messaging-utils/options-messaging.js')
const EMManagement = require('./enterprise-messaging-utils/EMManagement.js')

class EnterpriseMessagingShared extends BaseMessaging {
  getClient() {
    const optionsAMQP = optionsMessaging(this.options, 'amqp10ws')
    return new AMQPClient(optionsAMQP, this.optionsApp, { topic: 'topic:', queue: 'queue:' })
  }

  getManagement() {
    return new EMManagement(this.options)
  }

  get keepConnection() {
    return true
  }
}

module.exports = EnterpriseMessagingShared
